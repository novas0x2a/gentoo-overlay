From 6b0e2f66f4372b8cbf461e1e31b649b0309392a2 Mon Sep 17 00:00:00 2001
From: Mike Lundy <mike@fluffypenguin.org>
Date: Sat, 9 Jan 2010 08:16:36 -0800
Subject: [PATCH 2/2] build a kdu_apps shared library

---
 kakadu-6.4.1/apps/make/Makefile-Linux-x86-64-gcc |    9 ++++++++-
 1 files changed, 8 insertions(+), 1 deletions(-)

diff --git a/kakadu-6.4.1/apps/make/Makefile-Linux-x86-64-gcc b/kakadu-6.4.1/apps/make/Makefile-Linux-x86-64-gcc
index f2939fc..62ffa46 100644
--- a/kakadu-6.4.1/apps/make/Makefile-Linux-x86-64-gcc
+++ b/kakadu-6.4.1/apps/make/Makefile-Linux-x86-64-gcc
@@ -23,11 +23,14 @@ all ::              most kdu_hyperdoc kdu_text_extractor
 
 all_but_hyperdoc :: most kdu_text_extractor
 
-most :: kdu_compress kdu_expand kdu_buffered_compress kdu_buffered_expand kdu_transcoder kdu_maketlm kdu_render simple_example_c simple_example_d kdu_v_compress kdu_v_expand kdu_merge kdu_server kdu_server_admin kdu_vex_fast
+most :: kdu_compress kdu_expand kdu_buffered_compress kdu_buffered_expand kdu_transcoder kdu_maketlm kdu_render simple_example_c simple_example_d kdu_v_compress kdu_v_expand kdu_merge kdu_server kdu_server_admin kdu_vex_fast libkdu_apps_v64R.so
 
 clean:
 	rm -f *.o *.so *.a
 
+libkdu_apps_v64R.so :: args.o image_in.o image_out.o jp2.o jpx.o kdcs_comms.o kdu_client_window.o kdu_region_compositor.o kdu_region_decompressor.o kdu_security.o kdu_stripe_compressor.o kdu_stripe_decompressor.o kdu_tiff.o mj2.o palette.o roi_sources.o kdu_cache.o
+	$(CC) $(CFLAGS) -shared -o $(LIB_DIR)/libkdu_apps_v64R.so *.o $(LIB_SRC)
+
 kdu_compress :: args.o image_in.o kdu_tiff.o palette.o jp2.o jpx.o roi_sources.o ../kdu_compress/kdu_compress.cpp $(LIB_SRC)
 	$(CC) $(CFLAGS) ../kdu_compress/kdu_compress.cpp \
 	      args.o image_in.o kdu_tiff.o palette.o jp2.o jpx.o \
@@ -199,3 +202,7 @@ kdu_client_window.o :: ../client_server/kdu_client_window.cpp
 kdu_security.o :: ../kdu_server/kdu_security.cpp
 	$(CC) $(CFLAGS) -c ../kdu_server/kdu_security.cpp \
 	      -o kdu_security.o
+
+kdu_cache.o :: ../caching_sources/kdu_cache.cpp
+	$(CC) $(CFLAGS) -c ../caching_sources/kdu_cache.cpp \
+	      -o kdu_cache.o
-- 
1.7.4.rc2

